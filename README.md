Потратив 2 години як і казали (на каунтері більше бо відходив). Незнаю чи так бо не впевнений в реалізації, але логіка десь така  
